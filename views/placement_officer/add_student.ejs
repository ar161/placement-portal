<!-- views/placement_officer/add_student.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Student</title>
  <link rel="stylesheet" href="../../css/dashboard.css">
</head>
<body>

  <nav class="navbar">
    <!-- Include your navbar code here -->
  </nav>

  <% if (error) { %>
    <div style="color: red;"><%= error %></div>
  <% } else if (success) { %>
    <div style="color: green;"><%= success %></div>
  <% } %>

  <div class="main-content">
    <h1>Add Student</h1>
    <form action="/placement_officer/add_student" method="post">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" required><br>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required><br>
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br>
        <button type="submit">Add Student</button>
    </form>

    <!-- Button for uploading a file to add multiple students -->
    <form id="fileForm" action="/placement_officer/add_students_from_file" method="POST" enctype="multipart/form-data">
      <!-- File input for uploading an Excel file -->
      <input type="file" id="filePicker" name="file" accept=".xlsx, .xls" style="display: none;">
      <!-- Button for opening file picker and submitting the form -->
      <button type="button" onclick="openFilePicker()">Choose File</button>
    </form>
    
    <!-- Button for downloading the Excel template -->
    <form method="get" action="../../ExcelTemplates/AddStudentTemplate.xlsx">
      <button type="submit">Download Add Student Template</button>
    </form>

  </div>

  <script>
      function openFilePicker() {
        // Trigger click event on file input
        document.getElementById('filePicker').click();
      }
    
      document.getElementById('filePicker').addEventListener('change', function() {
        document.getElementById('fileForm').submit();
      });
  </script>

</body>
</html>